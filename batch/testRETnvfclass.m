if ~exist('dbf')
   dbf=1;
end
if ~exist('xbpdark')| ~exist('xbpwhite')
   testRETblob;
end;
if ~exist('pftwhite') | ~exist('pftdark') 
   testRETnvffeatures;
end;

% View paramters
if ~exist('optionsview')
   optionsview=struct('name',[],'path',[],'type',[],'fvn',0,'title',[]);
end
if ~isfield(optionsview,'name')
   optionsview.filename=[];
end
if ~isfield(optionsview,'path')
   optionsview.path=[];
end
if isempty(optionsview.name) | isempty(optionsview.path)
   [optionsview.name,optionsview.path]=uigetfile('*.*','Image File Name ...');
   if optionsview.name==0
      clear optionsview
      error('Invalid file name')
   end
end
if ~isfield(optionsview,'type')
   optionsview.type=[];
end
if ~isfield(optionsview,'fvn')
   optionsview.fvn=0;
end
if ~isfield(optionsview,'title')
   optionsview.title=[];
end

% Fisher transform matrices
optionsclass.type=1;
optionsclass.twhite=[-0.25452655779539, -0.04301136242404,  -0.35857676225603;
   0.17293385716782,  -0.03434996716158,   0.22288044025862;
   0.10177544328391,  -0.02860113722914,   0.03659682431327;
  -0.70732514826921,  -0.42240461772107,  -0.70218005025994;
  -0.50117236655069,  -0.10455914945179,  -0.42603431851442;
  -0.00361987544463,   0.21772297918225,   0.07367518417369;
   0.11145573857564,  -0.52919914663551,  -0.00638180299587;
   0.00081672088129,   0.06984732072072,   0.04251287735301;
  -0.13502395324045,  -0.11421632541011,  -0.13207749032947;
  -0.05919933622153,   0.11215476896911,  -0.10606089345574;
  -0.21894760289393,   0.16532053540461,  -0.12509555930253;
  -0.05368934991371,   0.00229379882769,   0.13304392516106;
   0.06152952762608,   0.34844315733883,  -0.07098858386694;
  -0.16437563754096,   0.14887617590820,  -0.03312487130550;
   0.08514587669332,  -0.11819312821788,   0.04766121475417;
  -0.03897285901496,   0.33899787601773,   0.11460295017235;
  -0.08521187631770,   0.08739499913923,  -0.06989936045613;
   0.00005886068365,   0.00042870242030,   0.00004142063563;
  -0.00276737657365,   0.00395611090641,   0.00252972351441;
   0.00412823388815,  -0.00881988809797,  -0.00078996878327;
   0.00470238049235,   0.00912046353366,   0.00174468963690;
  -0.00233040579219,  -0.00986793472218,  -0.00108705942070;
  -0.00734737656818,   0.05164689064306,   0.00578256058886;
   0.00191386706465,  -0.05816373972032,  -0.00878599304253;
   0.01185157858739,   0.02099833924826,  -0.00787413576423;
  -0.00181838776064,   0.01450557689162,  -0.00624583773665;
   0.00479131091697,   0.01440745563199,  -0.00460489433817;
   0.01735532762235,  -0.28162070804847,  -0.15091428760362;
  -0.07549197257653,   0.04424170474554,  -0.09083814850635;
  -0.01573348706102,   0.04674592775862,   0.04613900157930;
   0.02428797905298,  -0.07758920243351,   0.05730213192572;
  -0.01282455268187,  -0.02163413959074,   0.00201020079035;
   0.04615101644263,  -0.03222393127723,   0.03989357571092;
  -0.00499072780832,   0.20656907932587,   0.09413547559029;
   0.04688659660827,  -0.01674024646657,   0.05414266715082;
   0.00000315148361,   0.00005805069160,   0.00001271552740;
  -0.00013961309637,   0.00341448888480,   0.00103233797013;
  -0.00021391859672,   0.00033395904674,   0.00004639540671;
   0.00038495124322,  -0.00246245175566,  -0.00029442477818;
   0.00305176625700,  -0.01626317507572,  -0.00508237310439];

optionsclass.tdark=[-0.42206117685350,  -0.22702108645388;
  -0.02110075936397,   0.31159769126659;
   0.01915124526682,   0.09062660446278;
   0.51477485497809,   0.47133218482220;
  -0.14866142580247,  -0.09499668363095;
  -0.63218111661204,   0.65444415628313;
   0.04967620215141,   0.02626226594167;
   0.02140858470876,   0.11896876156354;
   0.12200564597475,  -0.11801451751737;
  -0.02149786660185,  -0.00418860308314;
   0.01171699393756,  -0.06878628422133;
   0.03120542824686,  -0.05964579621560;
  -0.01726814800055,   0.02066590580959;
   0.00852870288742,  -0.05347269640075;
   0.33568604811255,  -0.36546121975208;
   0.00003328457250,  -0.00047711926220;
  -0.00192032001770,   0.00855117056030;
   0.00056443873877,  -0.00738602640221;
  -0.00178059781102,  -0.00039504344465;
  -0.00016144164568,   0.00152792943505;
  -0.00247018727314,   0.00289642178463;
   0.00324385951785,  -0.00572454983843;
  -0.00310658954284,  -0.00028365895740;
  -0.00092289511271,  -0.00081035793421;
  -0.00240992614760,  -0.00227276660512;
  -0.03524352711681,  -0.07180361022042;
   0.01387995736284,  -0.02477325368965;
   0.01287457798550,   0.01550115950628;
   0.00473039096721,   0.00579699641924;
  -0.00224367957866,   0.00413335668657;
   0.00373479123290,   0.00566463900214;
   0.01230407485147,   0.05185541113484;
   0.00563323200837,   0.02806380157654;
  -0.00000004820427,   0.00000897197204;
  -0.00009096089038,   0.00004725504135;
  -0.00004937141558,  -0.00022987050288;
   0.00006550622145,   0.00004724809613;
  -0.00039884577507,   0.00268907484428];

% Classification parameters
optionsclass.mwhite=[-0.46470758541478,  -0.47094413938495,  -0.44836148885205,  -0.47418745019319;
   0.00618994146588,   0.16259657630902,  -0.01866876680084,  -0.02717093822968;
  -0.42534622586231,  -0.39959947004003,  -0.41321647996309,  -0.41271365067951]; 

optionsclass.mdark=[-0.02895113319741,  -0.01298970442883,  -0.01139044850450;
   0.18707774973650,   0.17907122010376,   0.18608482945123];

optionsclass.kwhite(:,:,1)=[0.03398479307803,  -0.00146784309240,  -0.00299782694183;
  -0.00146784309240,   0.73347759079079,  -0.09511321196707;
  -0.00299782694183,  -0.09511321196707,   0.06523915332213]*1e-3;

optionsclass.kwhite(:,:,2)=[0.00001898395883,  -0.00025351733809,  -0.00002952789543;
  -0.00025351733809,   0.00866251065778,   0.00153809951225;
  -0.00002952789543,   0.00153809951225,   0.00034124412125];

optionsclass.kwhite(:,:,3)=[0.05568215625142,  -0.00668971503267,   0.00601863612475;
  -0.00668971503267,   0.24101572773028,   0.01198088048630;
   0.00601863612475,   0.01198088048630,   0.03053737761816]*1e-3;

optionsclass.kwhite(:,:,4)=[0.04880738458792,   0.01928876748396,  -0.00250175846159;
   0.01928876748396,   0.30143494726761,  -0.04269412500472;
  -0.00250175846159,  -0.04269412500472,   0.03489779572112]*1e-3;

optionsclass.kdark(:,:,1)=[0.84673853868084,  -0.27099458603012;
  -0.27099458603012,   0.34746265859490]*1e-4;

optionsclass.kdark(:,:,2)=[0.16797866431743,   0.03820311525488;
   0.03820311525488,   0.45401658100383]*1e-4;

optionsclass.kdark(:,:,3)=[0.04317319752426,   0.00472021646058;
   0.00472021646058,   0.15537510718700]*1e-4;

                       
optionsclass.type=1;
tpftwhite=RETfishertrasf(pftwhite,optionsclass,dbf);
[clwhite,pwhite]=RETnvfclass(tpftwhite,optionsclass,dbf);

optionsclass.type=0;
tpftdark=RETfishertrasf(pftdark,optionsclass,dbf);
[cldark,pdark]=RETnvfclass(tpftdark,optionsclass,dbf);


      

   
   